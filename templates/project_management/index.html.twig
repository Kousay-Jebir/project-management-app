{% extends 'base.html.twig'%}

{% block title %}project management{% endblock %}

{% block body %}<ul class="project-management-nav br-15">
    <li class="project-management-nav-item"><a class="active" href="#">project overview</a></li>
    <li class="project-management-nav-item"><a href="#">all tasks</a></li>
    <li class="project-management-nav-item"><a href="#">assigned tasks</a></li>
    <li class="project-management-nav-item"><a href="#">chat room</a></li>
</ul>

<section class="project-management-dashboard">

    {{ form_start(form, { 'attr': {'class': 'add-task-form', 'name': ''} }) }}
    <div class="form-error">
        {{ form_errors(form) }}
    </div>

    <div class="form-row">
        {{ form_row(form.taskName, {'label': 'Task label'}) }}
        {{ form_row(form.taskDescription, {'label': 'Description'}) }}
        {{ form_row(form.assignedUser, {'label': 'Assignee'}) }}
    </div>
    {{ form_end(form) }}


    <div class="project-overview br-15 visible">

        <div class="chart-container">
            <canvas height="300px" id="myChart"></canvas>
        </div>

        <div class="chart-container">
            <canvas height="300px" id="progressChart"></canvas>
        </div>

        <div class="project-info">
            <div>
                <h2>Project name</h2>
                <p>{{project.projectName}}</p>
            </div>
            <div>
                <h2>Project description</h2>
                <p>{{project.projectDescription}}</p>
            </div>

        </div>

    </div>


    <table class="task-table">

        <thead>
            <tr>
                <th>task label</th>
                <th>status</th>
                <th>assignee</th>
                <th>due date</th>
                <th>task creator</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>

</section>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script type="module" src="{{asset('project_management/script.js')}}"></script>
<script src="{{asset('project_management/task_status_management.js')}}"></script>
{# <script src="{{asset('project_management/project_management_navigation.js')}}"></script> #}
<script>
    window.onload = function () {
        const ctx = document.getElementById('myChart');
        console.log(ctx);
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['Blocked', 'In progress', 'Done', 'In review'],
                datasets: [{
                    data: [40, 15, 15, 30],
                    backgroundColor: [
                        '#DC646A',
                        '#7F77F1',
                        '#33A069',
                        '#F9BE33'
                    ],
                    borderColor: '#f6f6f6'
                }]
            },
            options: {
                plugins: {
                    legend: {
                        display: false
                    }
                },

            }

        });


        // Sample data - Replace this with your actual data
        var teamMembers = ["Alice", "Bob", "Charlie", "David"];
        var tasksCompleted = [5, 12, 3, 12]; // Number of tasks completed by each team member
        var totalTasks = [10, 15, 8, 12]; // Total tasks assigned to each team member

        // Calculating progress percentage for each team member
        var progressPercentage = tasksCompleted.map((completed, index) => {
            return (completed / totalTasks[index]) * 100;
        });

        // Chart.js code
        var ctx2 = document.getElementById('progressChart');
        var progressChart = new Chart(ctx2, {
            type: 'bar',
            data: {
                labels: teamMembers,
                datasets: [{
                    data: progressPercentage,
                    backgroundColor: '#3C6E7180',
                    borderColor: '#284B63',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true,
                            max: 100
                        },
                        scaleLabel: {
                            display: true,
                            labelString: 'Progress Percentage (%)'
                        }
                    }],
                    xAxes: [{
                        scaleLabel: {
                            display: true,
                            labelString: 'Team Members'
                        }
                    }]
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    };
</script>
{% endblock %}
{% block stylesheets %}
<link rel="stylesheet" href='{{asset('styles/project_management_styles/style.css')}}'>
{% endblock %}